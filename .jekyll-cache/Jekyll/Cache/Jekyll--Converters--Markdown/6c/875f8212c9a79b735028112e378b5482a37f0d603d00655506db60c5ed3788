I"<p>我在给 dotnet 的 runtime 仓库提PR时，小伙伴告诉我可以使用 TryAdd 方法减少判断，但是我修改这个代码发现 100 个自动化测试都失败了，都告诉我没有找到这个方法</p>

<!--more-->

<!-- CreateTime:5/29/2020 10:29:45 AM -->

<p>在这个更改 <a href="https://github.com/dotnet/runtime/pull/37041">https://github.com/dotnet/runtime/pull/37041</a> 有小伙伴告诉我可以使用 TryAdd 方法减少判断，我添加之后发现差不多 100 个自动化测试都失败，提示下面代码</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'Dictionary&lt;string, string&gt;' does not contain a definition for 'TryAdd' and no accessible extension method 'TryAdd' accepting a first argument of type
</code></pre></div></div>

<p>原因是 Microsoft.Extensions.Configuration.CommandLine 这个库使用了 dotnet standard 2.0 版本</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;PropertyGroup&gt;
    &lt;TargetFrameworks&gt;netstandard2.0;&lt;/TargetFrameworks&gt;
    &lt;EnableDefaultItems&gt;true&lt;/EnableDefaultItems&gt;
  &lt;/PropertyGroup&gt;
</code></pre></div></div>

<p>而 TryAdd 方法是在 .NET Standard 2.1 才添加的，也就是 2.0 是没有这个方法</p>

<p><a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.dictionary-2.tryadd">Dictionary&lt;TKey,TValue&gt;.TryAdd(TKey, TValue) Method (System.Collections.Generic)</a></p>

:ET