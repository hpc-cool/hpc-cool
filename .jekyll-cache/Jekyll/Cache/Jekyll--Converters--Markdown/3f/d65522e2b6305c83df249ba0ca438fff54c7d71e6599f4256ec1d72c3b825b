I"[<p>最近遇到一个小伙伴问我，从一个很大的数强转，会不会抛出异常。实际上不会出现异常。</p>

<!--more-->

<!-- CreateTime:2018/7/29 14:24:01 -->

<p>最简单的代码是使用一个比 maxvalue 大的数，然后用它强转</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>         <span class="kt">long</span> <span class="n">tathkDucmmsc</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="n">MaxValue</span> <span class="p">;</span>
            <span class="n">tathkDucmmsc</span> <span class="p">*=</span> <span class="m">2</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">kuplStqfbbmx</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">tathkDucmmsc</span><span class="p">;</span> <span class="c1">// -2</span>
</code></pre></div></div>

<p>结果没有异常，只是拿到的值是 -2</p>

<p>但是因为默认是 <code class="language-plaintext highlighter-rouge">unchecked</code> 如果把上面的代码添加<code class="language-plaintext highlighter-rouge">checked</code>，那么就会出异常</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           <span class="k">checked</span>
            <span class="p">{</span>
                <span class="kt">long</span> <span class="n">tathkDucmmsc</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">;</span>
                <span class="n">tathkDucmmsc</span> <span class="p">*=</span> <span class="m">2</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">kuplStqfbbmx</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">tathkDucmmsc</span><span class="p">;</span>
            <span class="p">}</span>
</code></pre></div></div>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">System</span><span class="p">.</span><span class="n">OverflowException</span><span class="p">:</span><span class="err">“</span><span class="n">Arithmetic</span> <span class="n">operation</span> <span class="n">resulted</span> <span class="k">in</span> <span class="n">an</span> <span class="n">overflow</span><span class="p">.</span><span class="err">”</span>
</code></pre></div></div>

<p>但是对于 float ，他的值就不是这样了</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="k">checked</span>
            <span class="p">{</span>
                <span class="kt">double</span> <span class="n">hcmzgSsby</span> <span class="p">=</span> <span class="kt">float</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">;</span>

                <span class="n">hcmzgSsby</span> <span class="p">*=</span> <span class="m">2</span><span class="p">;</span>

                <span class="kt">float</span> <span class="n">djmmmkvawSswu</span> <span class="p">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">hcmzgSsby</span><span class="p">;</span>
            <span class="p">}</span>    
</code></pre></div></div>

<p>可以看到 djmmmkvawSswu 的值是 Infinity 不会出现异常，所以对于浮点数不要通过异常来判断强转是不是超过最大值。</p>

<p>那么如何判断 Infinity ？ 使用<code class="language-plaintext highlighter-rouge">float.IsInfinity</code>或 <code class="language-plaintext highlighter-rouge">double.IsInfinity</code> 都可以判断。</p>

<p><img src="https://i.loli.net/2018/04/08/5ac9ff8833a18.jpg" alt="" /></p>

:ET