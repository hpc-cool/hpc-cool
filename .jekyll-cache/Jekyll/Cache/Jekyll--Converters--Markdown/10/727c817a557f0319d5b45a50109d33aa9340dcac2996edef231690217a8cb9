I"1<p>在 WPF 新建用户用户控件时，偶尔的 VS 版本会逗你，给你创建了一个编码不对或偷偷给你的文件第一个字符添加了一个不可见字符，此时将会构建不通过</p>

<!--more-->

<!-- CreateTime:6/1/2020 10:26:50 AM -->

<p>在构建的时候提示下面代码</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Error</span> <span class="n">MC3000</span><span class="p">:</span> <span class="err">'</span><span class="n">Data</span> <span class="n">at</span> <span class="n">the</span> <span class="n">root</span> <span class="n">level</span> <span class="k">is</span> <span class="n">invalid</span><span class="p">.</span> <span class="n">Line</span> <span class="m">1</span><span class="p">,</span> <span class="n">position</span> <span class="m">1.</span><span class="err">'</span> <span class="n">XML</span> <span class="k">is</span> <span class="n">not</span> <span class="n">valid</span><span class="p">.</span> <span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</code></pre></div></div>

<p>此时的原因要么是编码的原因，要么是偷偷写入了第一个看不见的字符</p>

<p>如果是编码原因可以尝试使用我的 VS 插件，点击 <a href="https://marketplace.visualstudio.com/items?itemName=lindexigd.vs-extension-18109">Encoding normalize tool</a> 下载安装，之后就可以在插件这里转换某个文件的编码</p>

<p>第二个方案是在修复 Utf8 之后依然不让通过，可以尝试新建一个 xml 文件</p>

<p>然后复制 xaml 文件的内容到这个 xml 文件里面，复制 xaml 文件名，删除 xaml 文件，重命名 xml 文件为 xaml 文件名</p>

<p>注意 csproj 文件里面需要保持 xaml 文件的引用关系，如使用 Page 引用同时设置构建</p>

<p>如下代码放在 csproj 表示让所有 xaml 文件使用页面形式构建</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;Compile</span> <span class="na">Update=</span><span class="s">"**\*.xaml.cs"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;DependentUpon&gt;</span>%(Filename)<span class="nt">&lt;/DependentUpon&gt;</span>
    <span class="nt">&lt;/Compile&gt;</span>
    <span class="nt">&lt;Page</span> <span class="na">Include=</span><span class="s">"**\*.xaml"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;SubType&gt;</span>Designer<span class="nt">&lt;/SubType&gt;</span>
      <span class="nt">&lt;Generator&gt;</span>MSBuild:Compile<span class="nt">&lt;/Generator&gt;</span>
    <span class="nt">&lt;/Page&gt;</span>
</code></pre></div></div>

<p>如需要特定某个文件可使用如下代码</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;Compile</span> <span class="na">Update=</span><span class="s">"Foo.xaml.cs"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;DependentUpon&gt;</span>Foo.xaml<span class="nt">&lt;/DependentUpon&gt;</span>
    <span class="nt">&lt;/Compile&gt;</span>
    <span class="nt">&lt;Page</span> <span class="na">Include=</span><span class="s">"Foo.xaml"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;SubType&gt;</span>Designer<span class="nt">&lt;/SubType&gt;</span>
      <span class="nt">&lt;Generator&gt;</span>MSBuild:Compile<span class="nt">&lt;/Generator&gt;</span>
    <span class="nt">&lt;/Page&gt;</span>
</code></pre></div></div>

:ET