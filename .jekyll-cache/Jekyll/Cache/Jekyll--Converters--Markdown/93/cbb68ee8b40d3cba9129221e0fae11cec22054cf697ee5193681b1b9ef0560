I"L<p>本文告诉大家如何将 IRandomAccessStream 和 Stream 互转</p>

<!--more-->

<!-- CreateTime:2019/1/29 16:33:30 -->

<div id="toc"></div>

<p>如果在使用网络传输文件的时候，在 UWP 经常使用将 IRandomAccessStream 和 Stream 互转。</p>

<p>因为在 UWP 使用打开文件作为流的最简单代码如下</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">IRandomAccessStream</span> <span class="n">randomAccessStream</span> <span class="p">=</span> <span class="k">await</span> <span class="n">File</span><span class="p">.</span><span class="nf">OpenAsync</span><span class="p">(</span><span class="n">FileAccessMode</span><span class="p">.</span><span class="n">Read</span><span class="p">)</span>
</code></pre></div></div>

<p>这时通过 <code class="language-plaintext highlighter-rouge">using System.IO;</code> 可以使用扩展方法将 IRandomAccessStream 转 Stream 请看下面代码</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">randomAccessStream</span><span class="p">.</span><span class="nf">AsStream</span><span class="p">();</span>
</code></pre></div></div>

<p>如果需要反过来将 stream 转 IRandomAccessStream 也是同样需要引用 <code class="language-plaintext highlighter-rouge">using System.IO;</code> 来让代码可以写出扩展方法</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>

<span class="n">IRandomAccessStream</span> <span class="n">randomAccessStream</span> <span class="p">=</span> <span class="n">stream</span><span class="p">.</span><span class="nf">AsRandomAccessStream</span><span class="p">();</span>
</code></pre></div></div>

<p>https://stackoverflow.com/a/33221178/6116637</p>

:ET