I"V<p>感谢 Vatsan Madhavan 小伙伴推荐的 MSBuild 输出日志可视化工具，这个工具可以使用漂亮的 WPF 界面预览 MSBuild 复杂的输出内容</p>

<!--more-->

<!-- CreateTime:5/21/2020 4:09:16 PM -->

<p>这是一个完全开源的工具，请看 <a href="https://github.com/KirillOsenkov/MSBuildStructuredLog">KirillOsenkov/MSBuildStructuredLog: A logger for MSBuild that records a structured representation of executed targets, tasks, property and item values.</a></p>

<p>这个工具的使用方法很简单，首先是在项目里面使用 MSBuild 命令加上 <code class="language-plaintext highlighter-rouge">/bl</code> 生成 <code class="language-plaintext highlighter-rouge">msbuild.binlog</code> 文件，如使用下面代码</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">msbuild</span> <span class="p">/</span><span class="n">bl</span>
</code></pre></div></div>

<!-- ![](image/MSBuild 输出日志可视化工具 MSBuild Structured Log Viewer 简介/MSBuild 输出日志可视化工具 MSBuild Structured Log Viewer 简介0.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F202052116956826.jpg" alt="" /></p>

<p>从官网 <a href="https://msbuildlog.com/">MSBuild Log Viewer</a> 下载最新版本</p>

<p>打开软件，将 <code class="language-plaintext highlighter-rouge">msbuild.binlog</code> 文件拖进去就可以显示日志的信息</p>

<!-- ![](image/MSBuild 输出日志可视化工具 MSBuild Structured Log Viewer 简介/MSBuild 输出日志可视化工具 MSBuild Structured Log Viewer 简介1.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2020521161167844.jpg" alt="" /></p>

<p>另外这个工具还提供了 NuGet 库可以用来读取 binlog 文件</p>

<p>先安装 <a href="https://www.nuget.org/packages/MSBuild.StructuredLogger">MSBuild.StructuredLogger</a> 库，然后使用下面代码</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Build.Logging.StructuredLogger</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">BinaryLogReadBuild</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">string</span> <span class="n">binLogFilePath</span> <span class="p">=</span> <span class="s">@"C:\temp\test.binlog"</span><span class="p">;</span>

        <span class="kt">var</span> <span class="n">buildRoot</span> <span class="p">=</span> <span class="n">BinaryLog</span><span class="p">.</span><span class="nf">ReadBuild</span><span class="p">(</span><span class="n">binLogFilePath</span><span class="p">);</span>
        <span class="n">buildRoot</span><span class="p">.</span><span class="n">VisitAllChildren</span><span class="p">&lt;</span><span class="n">CscTask</span><span class="p">&gt;(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">CommandLineArguments</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>这个软件用到了特别漂亮的 TreeView 欢迎小伙伴抄样式</p>

:ET